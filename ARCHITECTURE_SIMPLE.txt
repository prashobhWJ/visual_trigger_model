╔══════════════════════════════════════════════════════════════════════════════╗
║                    VIDEO TRIGGER MODEL ARCHITECTURE  ...                     ║
╚══════════════════════════════════════════════════════════════════════════════╝

INPUT
  │
  │ Video Frames (B, T, C, H, W)
  │ Timestamps (B, T)
  │
  ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                    STAGE 1: LIGHTWEIGHT ANALYSIS                            │
│                                                                              │
│  ┌──────────────────┐         ┌──────────────────┐                          │
│  │ Visual Encoder   │────────▶│ Visual Features  │                          │
│  │ (ResNet/Efficient│         │   (B, T, 512)    │                          │
│  │  Net)            │         └────────┬─────────┘                          │
│  │ 2-5 FPS          │                  │                                    │
│  └──────────────────┘                  │                                    │
│                                         ▼                                    │
│                              ┌──────────────────┐                            │
│                              │ Trigger Detector │                            │
│                              │ (LSTM + Classifier)                           │
│                              └────────┬─────────┘                            │
│                                       │                                      │
│                              ┌────────▼─────────┐                            │
│                              │ Trigger Probs    │                            │
│                              │ (B, T, num_classes)                           │
│                              └──────────────────┘                            │
└────────────────────────────────────────┬─────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                    STAGE 2: TIME-AWARE ENCODING                              │
│                                                                              │
│  ┌────────────────────────────────────────────────────────┐               │
│  │  Input Projection: 512 → 768                            │               │
│  └────────────────────┬─────────────────────────────────────┘               │
│                       │                                                     │
│         ┌─────────────┴─────────────┐                                       │
│         │                           │                                       │
│  ┌──────▼──────┐          ┌─────────▼─────────┐                            │
│  │ Timestamp   │          │ Positional         │                            │
│  │ Embedding   │          │ Encoding           │                            │
│  │ (Learnable) │          │ (Sinusoidal)       │                            │
│  └──────┬──────┘          └─────────┬─────────┘                            │
│         │                           │                                       │
│         └───────────┬───────────────┘                                       │
│                     │                                                       │
│         ┌───────────▼───────────┐                                           │
│         │  Add & Normalize      │                                           │
│         └───────────┬───────────┘                                           │
│                     │                                                       │
│         ┌───────────▼───────────┐                                           │
│         │  Temporal Encoder     │                                           │
│         │  (Transformer/LSTM)    │                                           │
│         └───────────┬───────────┘                                           │
│                     │                                                       │
│         ┌───────────▼───────────┐                                           │
│         │ Encoded Features      │                                           │
│         │ (B, T, 768)           │                                           │
│         └───────────────────────┘                                           │
└─────────────────────────────────────────┬───────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                    STAGE 3: TEMPORAL LLM                                     │
│                                                                              │
│  ┌────────────────────────────────────────┐                                 │
│  │ Feature → LLM Projection (768 → LLM)   │                                 │
│  └────────────────┬───────────────────────┘                                 │
│                   │                                                          │
│         ┌─────────▼─────────┐                                               │
│         │ Bidirectional LSTM│                                               │
│         │ (Temporal Reasoning)│                                              │
│         └─────────┬─────────┘                                               │
│                   │                                                          │
│         ┌─────────▼─────────┐                                               │
│         │ Base LLM          │                                               │
│         │ (GPT-2/LLaMA)     │                                               │
│         └─────────┬─────────┘                                               │
│                   │                                                          │
│         ┌─────────▼─────────┐                                               │
│         │ Output Projection  │                                               │
│         │ (LLM → vocab)       │                                               │
│         └─────────┬─────────┘                                               │
└────────────────────┼───────────────────────────────────────────────────────┘
                     │
                     ▼
              OUTPUT
         ┌────────────┴────────────┐
         │                         │
    ┌────▼─────┐          ┌───────▼──────┐
    │ Natural  │          │ Trigger       │
    │ Language │          │ Detections    │
    │ Analysis │          │ (Timestamp,    │
    │          │          │  Confidence)   │
    └──────────┘          └───────────────┘


═══════════════════════════════════════════════════════════════════════════════

DIMENSION FLOW:

Input:          (B, T, C, H, W)     →  (8, 100, 3, 224, 224)
    │
    ├─→ Visual Encoder
    │       └─→ (B, T, 512)         →  (8, 100, 512)
    │
    ├─→ Trigger Detector
    │       └─→ (B, T, num_classes) →  (8, 100, 2)
    │
    ├─→ Time-Aware Encoder
    │       └─→ (B, T, 768)         →  (8, 100, 768)
    │
    └─→ Temporal LLM
            └─→ (B, T, vocab_size)  →  (8, 100, 50257)


═══════════════════════════════════════════════════════════════════════════════

KEY FEATURES:

✓ Efficiency: Only processes 2-5 FPS for trigger detection
✓ Selective Processing: LLM analysis only on triggered frames
✓ Temporal Awareness: Multiple mechanisms (PE, timestamps, BiLSTM, attention)
✓ Modularity: Each stage can be frozen/updated independently
✓ Flexibility: Supports different backbones and LLMs

